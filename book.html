<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>운명테라피 예약</title>
<style>
  body{font-family:system-ui, sans-serif; line-height:1.6; margin:0; padding:24px; background:#fafafa;}
  .wrap{max-width:720px; margin:0 auto; background:#fff; padding:24px; border-radius:12px; box-shadow:0 6px 24px rgba(0,0,0,.06)}
  h1{margin-top:0}
  label{display:block; font-weight:600; margin:14px 0 6px}
  input, select, textarea{width:100%; padding:12px; border:1px solid #ddd; border-radius:8px; font-size:16px}
  button{margin-top:18px; padding:12px 16px; border:0; border-radius:10px; font-size:16px; cursor:pointer}
  .primary{background:#111; color:#fff}
  .row{display:grid; grid-template-columns:1fr 1fr; gap:12px}
  .note{font-size:13px; color:#555}
  .success{background:#ecfff2; border:1px solid #b6f0c9; padding:12px; border-radius:8px; margin-top:16px; display:none}
  .error{background:#fff3f3; border:1px solid #ffc9c9; padding:12px; border-radius:8px; margin-top:16px; display:none}
</style>
</head>
<body>
<div class="wrap">
  <h1>운명테라피 예약</h1>
  <p class="note">주 1–2회만 받습니다. 선착순 확정 안내 메일을 드립니다.</p>

  <form id="booking">
    <label>이름</label>
    <input name="name" required>

    <div class="row">
      <div>
        <label>이메일</label>
        <input type="email" name="email" required>
      </div>
      <div>
        <label>상담 유형</label>
        <select name="type">
          <option value="첫 상담(60분)">첫 상담(60분)</option>
          <option value="크리에이터 코칭(75분)">크리에이터 코칭(75분)</option>
          <option value="보살 입문(90분)">보살 입문(90분)</option>
        </select>
      </div>
    </div>

    <label>희망 일시</label>
    <input type="datetime-local" name="date" required>

    <label>메모(선택)</label>
    <textarea name="note" rows="4" placeholder="요청/최근 고민, Zoom여부, 대면 희망 지역 등"></textarea>

    <input type="hidden" name="source" id="utm">
    <button class="primary">예약 요청 보내기</button>
  </form>

  <div id="ok" class="success">접수 완료! 확인 메일을 보내드렸어요. 24시간 이내 확정 메일이 도착합니다.</div>
  <div id="err" class="error">전송 중 오류가 있었어요. 잠시 후 다시 시도해주세요.</div>

  <p class="note">제출 시 개인정보 처리에 동의한 것으로 간주합니다. 본 예약 외 용도로는 사용하지 않습니다.</p>
</div>

<script>
const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbyEHvugrDHzln9SAx7n0Wj3JO2EW9RkF8PRfYtiX6c6yN1Tcixh_-5mK002MBeboAE/exec';

// 간단한 UTM 기록
document.getElementById('utm').value = location.search.replace('?','');

document.getElementById('booking').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const form = e.target;
  const body = Object.fromEntries(new FormData(form).entries());

  try{
    const res = await fetch(WEB_APP_URL, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify(body)
    });
    const json = await res.json();
    if(json.ok){
      form.reset();
      document.getElementById('ok').style.display='block';
      document.getElementById('err').style.display='none';
    }else{
      document.getElementById('ok').style.display='none';
      document.getElementById('err').style.display='block';
    }
  }catch(e){
    document.getElementById('ok').style.display='none';
    document.getElementById('err').style.display='block';
  }
});
</script>
</body>
</html>
